# 第3章 关系数据库系统

## 3.1 关系数据库系统概述

关系数据库系统的优点：

> 1. 数据结构 (二维表) 简单
> 2. 使用方便
> 3. 功能强
> 4. 数据独立性高
> 5. 理论基础深
> 6. 可移植性好
> 7. 标准化程度高
> 8. 分布式功能
> 9. 开放性
> 10. 其他方面的功能扩展

## 3.2 关系数据库系统衡量准则

完全关系型的12条严格标准

> 1. 信息准则
> 2. 确保访问准则
> 3. 空值的关系处理准则
> 4. 基于资源管理的动态联机目录
> 5. 统一易用的数据子语言
> 6. 视图更新准则
> 7. 高级的插入、删除及修改操作
> 8. 物理数据独立性
> 9. 逻辑数据独立性
> 10. 数据完整性准则
> 11. 分布独立性
> 12. 无损害原则

## 3.3 关系模型数学理论 —— 关系代数

### 3.3.0 关系模型

#### 3.3.0.1 关系数据结构

**1. 表结构**
表框架：由n个命名的属性组成，n称为表的元数，每个属性有一个值域
元组：表框架中的每行数据称为元组，一个元组由n个元组分量组成，每个分量对应表框架的一个属性
一个表框架可存放m个元组，m称为表的基数
一个n元表框架和框架内的m个元组构成一个完整的二维表
> 二维表的性质：
    元组个数有限性
    元组唯一性
    元组次序无关性
    元组分量原子性
    属性名唯一性
    属性次序无关性
    分量值域统一性

满足以上性质的二维表称为**关系**
以符合上述条件的二维表为基本数据结构建立的模型称为**关系模型**
**2. 键(key)**
二维表中能*唯一最小标识元组的属性集*称为该表的**键/关键字**
**候选键&主键**
在一张二维表的所有候选键中被选中的候选键称为该表的主键/主关键字
**外键**
若表A中属性集F是表B的键，称该属性集F为表A的外键
表A为*引用表*，表B称为*被引用表*，A和B可以是同一张二维表
3. 关系(略)

#### 3.3.0.2 关系操纵

· 查询，插入，删除，修改
· 空值处理
数据删除的基本单位是元组
关系模型上的五种基本操纵功能：元组选择、属性指定、两个关系的合并、元组插入、元组删除
主键中不允许出现空值
**算术表达式中如出现空值，运算结果也为空值**
逻辑运算表达式中如出现空值，运算结果为**逻辑假**

#### 3.3.0.3 关系中的数据约束

实体完整性约束：主键中属性不能有空值
参照完整性约束：外键要么取空值，要么是被引用表中当前存在的某元组上的主键值
用户定义的完整性：用户自己定义的属性取值约束

### 3.3.1 关系的表述

**笛卡尔积**
设存在 $n$ 个集合 $D_{1},D_{2},...D_{n}$, 其笛卡尔乘积是: $D_{1}\times D_{2}\times ... \times D_{n}$.
**关系R**
n元关系R是一个n元有序组的集合

### 3.3.2 关系操纵的表示

**定义：相容表:** 若表R与S有相同的标题，则R与S相容 (值域相同、意义相同)

传统集合运算：并、交、差(差运算无交换律、结合律)
注：交运算不是基本运算. $R\cap S=R-(R-S)=S-(S-R)$

**并运算&差运算**
条件：参加运算的两个关系必须是同类关系(属性个数相同，对应列所表属性具有相同值域)

**投影(Projection)运算: $\Pi_{B_{1}}(R)$**
**略去**关系中的某些列并**重新安排**剩余列的排列**次序**
注意消除结果关系中可能出现的重复元组

**选择(Selection)运算: $\sigma_{F}(R)$**
关系模式不变，由满足条件的元组组成

投影和选择复合运算默认运算顺序为从右到左(无括号)
**投影运算不满足交换律**
选择运算满足交换律
一般来说，投影运算和选择运算**不能**相互交换：
    如 $\Pi_{A}(\sigma_{F}(R))$ 和 $\sigma_{F}(\Pi_{A}(R))$
    若第二个表达式合法 (即能够执行), 则可用第一个表达式代替第二个表达式

### 3.3.3 关系模型与关系代数

**关系的笛卡尔乘积: $R\times S$**
两个关系的合并运算
乘积属性为两关系属性之和
笛卡尔乘积满足交换律和结合律
若R和S中有相同属性名，必须对结果关系中其中一个换名

**查询操作**
单个关系：选择+投影
多个关系：先用笛卡尔乘积将多个关系合并，再执行单个关系查询

### 3.3.4 关系代数中的扩充运算

**1. 交运算(略)**
**2. 除运算: $R\div S$**
运算条件: $\it{Head(S)\subset Head(R)}$
S 为除数关系, R 为被除数关系, 结果关系称为商.
令 $T=R\div S$
关系模式: $\it{Head(T)=Head(R)-Head(S)}$
结果元组: 看ppt119页开始的例子.
> 除运算与笛卡尔乘积的关系:
    若 $\it{R=T\times S}$, 则 $\it{T=R\div S}$, $\it{S=R\div T}$;
    若 $\it{T=R\div S}$, 则 $\it{T\times S\subseteq R}$.

**连接运算: $\it{R\bowtie S}$**
&emsp;&emsp;&emsp;&emsp;&emsp;&ensp; $\it{F}$
根据条件条件 $F$ 将关系 $R$ 和关系 $S$ 合并为一个关系.
结果关系为原两个关系全部属性之并集，不必消除同名属性，但必须对其进行换名.
基本条件: $\it{i\space\theta\space j}$, 其中 $i$ 为 $R$ 中的属性, $j$ 为 $S$ 中的属性, $\theta$ 为比较运算符.
$\it{R\bowtie S=\sigma_{F}(R\times S)}$
&emsp; $\it{F}$

**自然连接运算: $\it{R\bowtie S}$**
根据两个关系中的同名属性进行*等值*连接.

其他连接运算: 外连接, 左外连接, 右外连接.
左外连接以左侧关系为主体，右外连接同理.

### 3.3.5 关系代数实例

略, 看PPT.
